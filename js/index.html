<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width-device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="paperdox" />
    <title>alternis web test</title>
    <style>
      html,
      body {
        height: 100%;
        width: 100%;
        margin: 0;
      }

      #root {
        height: 100%;
      }
    </style>
  </head>
  <body>
    <noscript>You need JavaScript to run this app.</noscript>
    <script type="module" src="./src/index.ts"></script>
    <script type="module">
      import "./src/index.ts"
      import { makeDialogueContext } from "./src/index.ts";

      const smallTestJson = {
        "entryId": 0,
        "nodes": [
          {
            "id": 0,
            "line": {
              "data": {
                "speaker": "test",
                "text": "hello world!"
              },
              "next": 1
            }
          },
          {
            "id": 1,
            "line": {
              "data": {
                "speaker": "test",
                "text": "goodbye cruel world!"
              }
            }
          }
        ]
      };

      const ctx = await makeDialogueContext(JSON.stringify(smallTestJson));

      const step_result_1 = ctx.step();
      assert.deepStrictEqual(step_result_1, {
        line:  {
          speaker: "test",
          text: "hello world!",
          metadata: undefined,
        },
      });

      const step_result_2 = ctx.step();
      assert.deepStrictEqual(step_result_2, {
        line:  {
          speaker: "test",
          text: "goodbye cruel world!",
          metadata: undefined,
        },
      });

      const step_result_3 = ctx.step();
      assert.deepStrictEqual(step_result_3, {
        none: undefined,
      });

      ctx.dispose();
    </script>
  </body>
</html>
